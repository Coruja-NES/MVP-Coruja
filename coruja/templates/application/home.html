{% extends "base.html" %}
{% set active_page = "home" %}
{% from "macros.html" import render_table %}

{% block content %}
<div class="container my-auto px-3 mx-auto w-75">
    <div class="text-center">
        <h2 class="h2 fw-normal mb-4">
            <i class="bi bi-buildings-fill"></i> 
            Órgãos
        </h2>

        <form class="d-flex mb-4 w-50 m-auto" role="search">
            <div class="input-group">
                <i class="input-group-text bi bi-search" aria-hidden="true"></i>
                <input class="form-control" type="text" placeholder="Buscar pelo nome do órgão">
            </div>
        </form>

        {% if current_user.role.name == 'admin' %}
            <div class="position-fixed bottom-0 end-0 m-5">
                <a
                href="{{ url_for('organ.get_post_organ_creation') }}"
                class="btn btn-primary m-5 btn-lg btn-circle" 
                >
                <i class="bi bi-plus-lg"></i>
                </a>
            </div>
        {% endif %}
    </div>

        {{render_table(organs, "organ")}}
    </div>
</div>
{% endblock %}


{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const searchBar = document.getElementById('searchBar');
        const orgaoCards = document.querySelectorAll('.orgao-card');

        searchBar.addEventListener('input', function () {
            const query = searchBar.value.toLowerCase();

            orgaoCards.forEach(function (card) {
                const nomeOrgao = card.querySelector('.orgao-name').innerText.toLowerCase();
                if (nomeOrgao.includes(query)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        });
    });
</script>
{% endblock %}