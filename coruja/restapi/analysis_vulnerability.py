from flask import Blueprint, Flask, render_template
from flask_login import login_required

from ..decorators import proxy_access
from ..utils import database_manager

bp = Blueprint(
    "analysis_vulnerability", __name__, url_prefix="/analise-vulnerabilidade"
)


@bp.route("/<int:analysis_vulnerability_id>")
@login_required
# @proxy_access(kind_object="analysis_vulnerability", kind_access="read")
def get_analysis_vulnerability(analysis_vulnerability_id: int):
    """Renderiza detalhes sobre uma determinada Análise de Vulnerabilidade

    Args:
        analysis_vulnerability_id (int): ID da Análise de Vulnerabilidade
    """

    analysis_vulnerability = database_manager.get_analysis_vulnerability(
        analysis_vulnerability_id
    )

    return render_template(
        "analysis_vulnerability/analysis_vulnerability.html",
        analysis_vulnerability=analysis_vulnerability,  # type: ignore
    )


def init_api(app: Flask) -> None:
    app.register_blueprint(bp)
