from flask import Blueprint, Flask
from flask_login import login_required

from ..decorators import proxy_access

bp = Blueprint("analysis_vulnerability", __name__, "analise-vulnerabilidade")


@bp.route("/<int:analysis_vulnerability_id>")
@login_required
@proxy_access(kind_object="analysis_vulnerability", kind_access="read")
def get_analysis(analysis_vulnerability_id: int):
    return "Em construção"


def init_api(app: Flask) -> None:
    app.register_blueprint(bp)
